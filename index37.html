<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>時區轉換器</title>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f4f8;
            padding: 20px;
        }
        h1 { text-align: center; }
        .timezone-converter {
            max-width: 600px;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        .row label { flex: 1; margin-right: 10px; align-self: center; }
        .row input, .row select {
            flex: 2;
            padding: 6px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }
        footer { text-align: center; margin-top: 20px; color: #666; }
    </style>
</head>
<body>
    <h1>時區轉換器</h1>
    <div class="timezone-converter" id="converter"></div>
    <footer>作者: 李振偉</footer>

    <script>
        const { DateTime } = luxon;

        // 支援城市清單
        const cityList = [
            { name: "台北", zone: "Asia/Taipei" },
            { name: "紐約", zone: "America/New_York" },
            { name: "倫敦", zone: "Europe/London" },
            { name: "東京", zone: "Asia/Tokyo" },
            { name: "雪梨", zone: "Australia/Sydney" }
        ];

        const numRows = 3; // 可自由增加行數
        const container = document.getElementById("converter");

        // 建立表格列
        for(let i=0; i<numRows; i++){
            const row = document.createElement("div");
            row.className = "row";
            row.innerHTML = `
                <label>城市 ${i+1}:</label>
                <select class="city-select"></select>
                <input type="datetime-local">
            `;
            container.appendChild(row);

            const select = row.querySelector(".city-select");
            cityList.forEach(c => {
                const opt = document.createElement("option");
                opt.value = c.zone;
                opt.textContent = c.name;
                select.appendChild(opt);
            });
        }

        const rows = Array.from(document.querySelectorAll(".row"));

        function updateTimes(changedRowIndex){
            const changedRow = rows[changedRowIndex];
            const changedSelect = changedRow.querySelector(".city-select");
            const changedInput = changedRow.querySelector("input");

            if(!changedInput.value) return;

            // 取得 luxon 時區時間
            const dt = DateTime.fromISO(changedInput.value, { zone: changedSelect.value });

            rows.forEach((row, i) => {
                if(i === changedRowIndex) return;

                const sel = row.querySelector(".city-select");
                const inp = row.querySelector("input");

                const newDt = dt.setZone(sel.value);
                inp.value = newDt.toFormat("yyyy-LL-dd'T'HH:mm");
            });
        }

        // 綁定事件
        rows.forEach((row, idx) => {
            const input = row.querySelector("input");
            const select = row.querySelector(".city-select");

            input.addEventListener("input", () => updateTimes(idx));
            select.addEventListener("change", () => updateTimes(idx));
        });
    </script>
</body>
</html>
