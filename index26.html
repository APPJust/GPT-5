<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>打字速度測試</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 30px;
    background-color: #f0f4f8;
  }
  h1 {
    margin-bottom: 5px;
  }
  .author {
    font-size: 0.9em;
    color: #555;
    margin-bottom: 20px;
  }
  #textDisplay {
    border: 1px solid #ccc;
    padding: 15px;
    background-color: #fff;
    margin-bottom: 15px;
    min-height: 80px;
    font-size: 18px;
    line-height: 1.5;
    white-space: pre-wrap;
  }
  #inputArea {
    width: 100%;
    padding: 10px;
    font-size: 18px;
    border: 1px solid #ccc;
    box-sizing: border-box;
  }
  #stats {
    margin-top: 15px;
    font-size: 16px;
  }
  #restartBtn {
    margin-top: 15px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
  }
  .correct {
    color: green;
  }
  .incorrect {
    color: red;
  }
</style>
</head>
<body>

<h1>打字速度測試</h1>
<div class="author">作者: 李振偉</div>

<div id="textDisplay"></div>
<textarea id="inputArea" rows="4" placeholder="開始打字..."></textarea>

<div id="stats">
  <div>速度: <span id="wpm">0</span> WPM</div>
  <div>正確率: <span id="accuracy">100</span>%</div>
</div>

<button id="restartBtn">重新開始</button>

<script>
const texts = [
  "生活就像一盒巧克力，你永遠不知道下一個是什麼味道。",
  "千里之行，始於足下。",
  "不經一事，不長一智。",
  "學而不思則罔，思而不學則殆。",
  "時間就像海綿裡的水，只要願擠，總還有的。"
];

let startTime, interval;

const textDisplay = document.getElementById("textDisplay");
const inputArea = document.getElementById("inputArea");
const wpmDisplay = document.getElementById("wpm");
const accuracyDisplay = document.getElementById("accuracy");
const restartBtn = document.getElementById("restartBtn");

function getRandomText() {
  const randomIndex = Math.floor(Math.random() * texts.length);
  return texts[randomIndex];
}

function startTest() {
  clearInterval(interval);
  const text = getRandomText();
  textDisplay.innerHTML = text;
  inputArea.value = "";
  startTime = null;
  wpmDisplay.textContent = 0;
  accuracyDisplay.textContent = 100;
}

function calculateStats() {
  const now = new Date();
  const input = inputArea.value;
  const text = textDisplay.textContent;

  if (!startTime) startTime = now;

  // 計算時間（分鐘）
  const minutes = (now - startTime) / 1000 / 60;

  // 計算 WPM
  const wordsTyped = input.trim().split(/\s+/).length;
  const wpm = Math.round(wordsTyped / minutes);
  wpmDisplay.textContent = isFinite(wpm) ? wpm : 0;

  // 計算正確率
  let correctChars = 0;
  for (let i = 0; i < input.length; i++) {
    if (input[i] === text[i]) correctChars++;
  }
  const accuracy = Math.round((correctChars / text.length) * 100);
  accuracyDisplay.textContent = isFinite(accuracy) ? accuracy : 100;
}

inputArea.addEventListener("input", calculateStats);
restartBtn.addEventListener("click", startTest);

// 初始化
startTest();
</script>

</body>
</html>
